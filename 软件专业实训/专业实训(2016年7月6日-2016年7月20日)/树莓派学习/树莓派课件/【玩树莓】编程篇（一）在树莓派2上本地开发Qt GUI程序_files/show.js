STK.register("kit.extra.language",function(a){window.$LANG||(window.$LANG={});return function(b,c){var d=a.core.util.language(b,$LANG);d=d.replace(/\\}/ig,"}");c&&(d=a.templet(d,c));return d}});
typeof scope=="undefined"&&(scope={});scope.loginKit=function(){if(window.scope){var a=window.scope.current_user_weibo||window.scope.current_user_sina;if(a)return{uid:a,isLogin:!!a}}if(window.$CONFIG){var a=window.$CONFIG.current_user_weibo||window.$CONFIG.current_user_sina;if(a)return{uid:a,isLogin:!!a}}var b=document.cookie+";",c=["SUP","=([^;]*)?;"].join(""),d=["(\\?|&)","uid","=([^&]*)(&|$)"].join(""),e=b.match(new RegExp(c,"i"));e=e?e[1]||"":"";e=unescape(e);var a=e.match(new RegExp(d));a=a?a[2]||"":"";var f=scope.$oid;return{uid:a,isLogin:!!a,isAdmin:a&&f&&a==f}};scope.$isLogin=function(){return scope.loginKit().isLogin};scope.$isAdmin=function(){return scope.loginKit().isAdmin};
STK.register("core.obj.parseParam",function(a){return function(a,b,c){var d,e={};b=b||{};for(d in a){e[d]=a[d];b[d]!=null&&(c?a.hasOwnProperty[d]&&(e[d]=b[d]):e[d]=b[d])}return e}});
STK.register("common.widget.log",function(a){var b={app_sharebutton:1,app_followbutton:2,app_livestream:4,app_listweibo:5,app_weiboshow:6,app_commentbox:7};return function(c){var d=a.core.obj.parseParam({vsrc:"app_weiboshow",refer:"",step:1},c),e=scope.refer||scope.$refer||d.refer,f=scope.loginKit().uid||"",g=scope.appkey||$CONFIG.$appkey||$CONFIG.appkey||0,h=b[d.vsrc]||"",i="http://rs.sinajs.cn/r.gif?uid="+f+"&appid="+g+"&refer="+e+"&cat="+h+"&step="+d.step+"&rnd="+ +(new Date),j=new Image;j.src=i;j=null}});
STK.register("common.widget.login",function(a){var b={vsrc:"app_weiboshow",appsrc:"",showlogo:0,callback:function(){}};typeof App=="undefined"&&(App={});return function(c){c=a.parseParam(b,c);c.appsrc||(c.appsrc=scope?scope.appsrc?scope.appsrc:scope.$appsrc?scope.$appsrc:"":"");var d={};App.loginBackUrlCallBack=function(b){a.custEvent.fire(d,"login",b);c.step=2;a.common.widget.log(c)};var e=function(){f();g();h();i()},f=function(){},g=function(){},h=function(){a.custEvent.define(d,"login")},i=function(){a.custEvent.add(d,"login",function(a){c.callback(a)})};d.showLogin=function(){var b="&"+a.jsonToQuery(c),d=navigator.userAgent.indexOf("360 Aphone Browser")>=0,e=/micromessenger\/(\d+\.\d+\.\d+)/i.test(navigator.userAgent);if(d||e)location.href="http://service.weibo.com/reg/loginindex.php?regbackurl=http%3A%2F%2Fweibo.com&backurl="+encodeURIComponent(location.href)+b+"&rnd="+ +(new Date).valueOf();else{var f="http://service.weibo.com/reg/loginindex.php?regbackurl=http%3A%2F%2Fweibo.com&backurl=http%3A%2F%2F"+location.host+"%2Fstaticjs%2FloginProxy.html"+b+"&rnd="+ +(new Date).valueOf();/weibo.com/.test(location.host)&&(f=f.replace(/\/widget/,""));var g=window.open(f,"miniblog_login",["toolbar=1,status=0,resizable=1,width=620,height=540,left=",(screen.width-620)/2,",top=",(screen.height-450)/2].join(""));g.focus();a.common.widget.log(c)}};e();return d}});
STK.register("module.layer",function(a){var b=function(a){var b={};if(a.style.display=="none"){a.style.visibility="hidden";a.style.display="";b.w=a.offsetWidth;b.h=a.offsetHeight;a.style.display="none";a.style.visibility="visible"}else{b.w=a.offsetWidth;b.h=a.offsetHeight}return b},c=function(c,d){d=d||"topleft";var e=null;if(c.style.display=="none"){c.style.visibility="hidden";c.style.display="";e=a.core.dom.position(c);c.style.display="none";c.style.visibility="visible"}else e=a.core.dom.position(c);if(d!=="topleft"){var f=b(c);if(d==="topright")e.l=e.l+f.w;else if(d==="bottomleft")e.t=e.t+f.h;else if(d==="bottomright"){e.l=e.l+f.w;e.t=e.t+f.h}}return e};return function(d){var e=a.core.dom.builder(d),f=e.list.outer[0],g=e.list.inner[0],h=a.core.dom.uniqueID(f),i={},j=a.core.evt.custEvent.define(i,"show");a.core.evt.custEvent.define(j,"hide");var k=null;i.show=function(){f.style.display="";a.core.evt.custEvent.fire(j,"show");return i};i.hide=function(){f.style.display="none";a.custEvent.fire(j,"hide");return i};i.getPosition=function(a){return c(f,a)};i.getSize=function(a){if(a||!k)k=b.apply(i,[f]);return k};i.html=function(a){a!==undefined&&(g.innerHTML=a);return g.innerHTML};i.text=function(b){text!==undefined&&(g.innerHTML=a.core.str.encodeHTML(b));return a.core.str.decodeHTML(g.innerHTML)};i.appendChild=function(a){g.appendChild(a);return i};i.getUniqueID=function(){return h};i.getOuter=function(){return f};i.getInner=function(){return g};i.getParentNode=function(){return f.parentNode};i.getDomList=function(){return e.list};i.getDomListByKey=function(a){return e.list[a]};i.getDom=function(a,b){return e.list[a]?e.list[a][b||0]:!1};i.getCascadeDom=function(b,c){return e.list[b]?a.core.dom.cascadeNode(e.list[b][c||0]):!1};return i}});
STK.register("ui.tipPrototype",function(a){var b=10003;return function(c){var d,e,f,g,h,i='<div node-type="outer" class="WB_widgets W_layer" style="position: absolute; display:none;" ><div node-type="inner" class="bg"></div></div>';d=a.parseParam({direct:"up",showCallback:a.core.func.empty,hideCallback:a.core.func.empty},c);e=a.module.layer(i,d);f=e.getOuter();g=e.getInner();e.setTipWH=function(){h=this.getSize(!0);this.tipWidth=h.w;this.tipHeight=h.h;return this};e.setTipWH();e.setContent=function(a){typeof a=="string"?g.innerHTML=a:g.appendChild(a);this.setTipWH();return this};e.setLayerXY=function(c){if(!c)throw"ui.tipPrototype need pNode as first parameter to set tip position";var e=STK.core.dom.position(c),g=e.l,h=c.offsetWidth,i=c.offsetHeight,j=Math.min(Math.max(g+(h-this.tipWidth)/2,a.scrollPos().left),a.scrollPos().left+STK.winSize().width-this.tipWidth),k=e.t;d.direct==="down"&&(k+=i);var l=[";"];l.push("z-index:",b++,";");l.push("width:",this.tipWidth,"px;");l.push("height:",this.tipHeight,"px;");l.push("top:",k,"px;");l.push("left:",j,"px;");f.style.cssText+=l.join("")};e.aniShow=function(){var b=this.getOuter();b.style.height="0px";b.style.display="";var c=a.core.ani.tween(b,{end:d.showCallback,duration:250,animationType:"easeoutcubic"});if(d.direct==="down")c.play({height:this.tipHeight},{staticStyle:"overflow:hidden;position:absolute;"});else{var e=parseInt(b.style.top,10)-this.tipHeight;c.play({height:this.tipHeight,top:Math.max(e,a.scrollPos().top)},{staticStyle:"overflow:hidden;position:absolute;"})}};e.anihide=function(){var b=this.getOuter(),c=this,e=a.core.ani.tween(b,{end:function(){b.style.display="none";b.style.height=c.tipHeight+"px";d.hideCallback()},duration:300,animationType:"easeoutcubic"});if(d.direct==="down")e.play({height:0},{staticStyle:"overflow:hidden;position:absolute;"});else{var f=parseInt(b.style.top,10)+this.tipHeight;e.play({height:0,top:f},{staticStyle:"overflow:hidden;position:absolute;"})}};document.body.appendChild(f);e.destroy=function(){document.body.removeChild(f);e=null};return e}});
STK.register("ui.tipAlert",function(a){var b=a.core.util.easyTemplate;return function(c){c=a.parseParam({direct:"up",className:"WB_widgets W_layer",showCallback:a.core.func.empty,hideCallback:a.core.func.empty,template:'<#et temp data><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td><div node-type="msgDiv" class="content layer_mini_info"><p class="clearfix alt_text"><span class="tip_icon WB_tipS_${data.type}"></span>${data.msg}&nbsp; &nbsp; &nbsp; </p></div></td></tr></tbody></table></#et>',type:"ok",msg:""},c);var d=a.ui.tipPrototype(c),e=d.getInner(),f=d.getOuter();f.className=c.className;e.className="bg";var g=c.template,h=a.builder(b(g,{type:c.type,msg:c.msg}).toString());d.setContent(h.box);var i=d.destroy;d.destroy=function(){i();d=null};return d}});
STK.register("common.widget.reg",function(a){var b=a.kit.extra.language,c=a.ui.tipAlert({className:"WB_tips_top",showCallback:function(){var a=c.getOuter();a.style.height="";a=null},template:'<#et temp data><div class="tips_inner"><span class="WB_tipS_warn"></span><span class="WB_icon_txt">'+b("#L{您的帐号尚未开通微博，}")+'<a href="http://weibo.com/signup/full_info.php?appsrc=6cm7D0&backurl='+encodeURIComponent(document.URL)+'&showlogo=0&vsrc=weiboshow&from=zw" target="_blank">'+b("#L{立即开通}")+"</a></span>"+"</#et>"});return function(b){if(!a.isNode(b))throw"[common.widget.reg] need node as first parameter";c.setLayerXY(b);c.aniShow();return c}});
STK.register("common.widget.addFollow",function(a){var b=a.kit.extra.language,c=function(){},d={uid:scope.loginKit().uid,url:"",fuid:"",appsrc:"",vsrc:"app_weiboshow",success:c,fail:c,btnTemp:""},e,f=function(c){if(c.fuid===c.uid){e.parentNode.innerHTML=b('<span class="WB_btnC"><span><em class="WB_btnicn_ok"></em><em>#L{你自己}</em></span></span>');return"yourself"}if(!c.url){c.url="/widget/weiboshow/aj_attention.php";/weibo.com/.test(location.host)&&(c.url="/weiboshow/aj_attention.php")}var d=c.btnTemp||'<span class="WB_btnC"><span><em class="WB_btnicn_ok"></em><em>#L{已关注}</em></span></span>';a.ajax({method:"post",url:c.url,args:{wsrc:$CONFIG.wsrc||"app_weibo_show",uid:c.uid,fuid:c.fuid},onComplete:function(g){switch(g.code){case"A00006":break;case"A10007":break;case-1:a.common.widget.reg(e);break;case-2:var h=a.common.widget.login();a.custEvent.add(h,"login",function(){c.uid=scope.loginKit().uid;f(c)});h.showLogin();break;case-3:}(g.code=="A00006"||g.code=="A10007")&&e&&(e.parentNode.innerHTML=b(d));typeof c.success=="function"&&c.success(g)},onFail:function(a){typeof c.fail=="function"&&c.fail(a)}})};return function(b,c){if(!b)throw"[common.widget.addFollow] need node as parameter";e=b;var g=function(){if(parent==self||parent==parent.parent){if(!scope.$isLogin()){var b=a.common.widget.login();a.custEvent.add(b,"login",function(){c.uid=scope.loginKit().uid;f(c)});b.showLogin();return}f(c)}},h={},i=function(){c=a.parseParam(d,c);c.fuid||(c.fuid=b.getAttribute("uid"));j()},j=function(){a.addEvent(b,"click",g)},k=function(){a.removeEvent(b,"click",g)};h.destroy=k;i();return h}});
STK.register("comp.widget.show.error",function(a){var b=a.addEvent,c=a.E("showTXA"),d=a.E("showTX"),e=a.E("showBtn"),f=a.kit.extra.language,g;return function(){var g={};if(!c)return g;var h=function(){e.style.display="none";d.style.display="block"},i=function(){var b=a.E("txContent").value,c="/widget/weiboshow/aj_addmblog.php";/weibo.com/.test(location.host)&&(c="/weiboshow/aj_addmblog.php");a.ajax({url:c,args:{appkey:$CONFIG.$appsrc,content:encodeURIComponent(b)},method:"post",onComplete:function(b){var c=b.code;switch(c){case"A00006":a.E("showTX").innerHTML=f("#L{提醒成功，辛苦了}");break;case"M01155":alert(f("#L{你刚才好像提醒一次了}"));break;case"M00005":var d=a.common.widget.login();d.showLogin();break;case"M00004":alert(f("#L{参数错误}"));break;case"M00006":alert(f("#L{你未开通微博。}"));break;case"M18003":alert(f("#L{提醒失败}"));break;default:alert(f("#L{提醒失败}"))}}})};b(c,"click",h);b(a.E("txBtn"),"click",i);var j=function(){a.removeEvent(c,"click",h);a.removeEvent(a.E("txBtn"),"click",i)};g.destroy=j;return g}});
STK.register("comp.widget.show.scroll",function(a){var b,c,d=location.search,e=a.E("weibo_list_con"),f=a.E("weibo_list"),g=a.E("fans_list_con"),h=a.core,i=h.evt.addEvent,j=h.evt.getEvent,k=h.evt.fireEvent,l=h.evt.stopEvent,m=h.arr.foreach,n=function(){},o=null,p=0,q=/speed=(\d+)/.test(d)?RegExp.$1:0,r=q||5,s="down";c={autoScroll:function(a,b){var b=b||r,d=f.offsetHeight-e.clientHeight;clearInterval(this._timer);this._timer=setInterval(function(){if(!!c.isOutRange){if(c.lock)return;var b=e.scrollTop;b=a=="down"?Math.min(b+2,d):Math.max(b-2,0);e.scrollTop=b;(b==0||b==d)&&c.stop(this._timer)}},b)},start:function(a,b){c.lock=!0;var b=b||r;s=a;var d=f.offsetHeight-e.clientHeight;clearInterval(this._timer);this._timer=setInterval(function(){var b=e.scrollTop;b=a==="down"?Math.min(b+2,d):Math.max(b-2,0);e.scrollTop=b;(b==0||b==d)&&c.stop()},b)},lock:!1,isOutRange:!0,scroll:function(a){clearTimeout(this.ctimer);if(!c.isOutRange){var b=e.scrollTop,d=f.offsetHeight-e.clientHeight;b=a.wheelDelta<=0||a.detail>0?Math.min(b+20,d):Math.max(b-20,0);e.scrollTop=b;if(b==0||b==d){n();return}l(a);this.ctimer=setTimeout(function(){n()},500)}},stop:function(a){clearInterval(a||this._timer);c.lock=!1;n()}};b=function(){if(!!a.E("weibo_con")&&a.E("weibo_con").style.display!="none"){e.style.position="relative";e.scrollTop=0;p=f.offsetTop;o=a.sizzle(".weiboShow_mainFeed_list",e);(function(){function d(){var a=e.scrollTop,d=parseInt(e.style.height);b.style.display=a==0?"none":"";c.style.display=a+d==f.offsetHeight?"none":""}var b=a.E("weibo_upbtn");if(!!b){b=b.getElementsByTagName("em")[0];var c=a.E("weibo_downbtn").getElementsByTagName("em")[0],g=null;n=function(){clearTimeout(g);setTimeout(d,200)}}})();n();if(o.length==0)return;(function(){var b=null;a.addEvent(e,"mouseover",function(){clearTimeout(b);c.isOutRange=!1;c.stop()});a.addEvent(e,"mouseout",function(a){clearTimeout(b);b=setTimeout(function(){c.isOutRange=!0;c.start(s)},50)})})();try{window.addEventListener("DOMMouseScroll",function(a){c.scroll(a||event)},!1)}catch(b){document.onmousewheel=function(a){c.scroll(a||event)}}(function(){if(q!=0){var a=f.offsetHeight-e.clientHeight;e.scrollTop=0;c.autoScroll("down",+q);setTimeout(function(){n()},+q)}})();m(["up","down"],function(b,d){i(a.E("weibo_"+b+"btn"),"mouseover",function(){c.stop()});i(a.E("weibo_"+b+"btn"),"mouseout",function(){c.start(b)});i(a.E("weibo_"+b+"btn"),"click",function(){c.start(b,5);setTimeout(function(){c.stop()},500)})})}};return function(){return{init_scroll:b,autoScroll:c}}});
STK.register("comp.widget.show.style",function(a){var b=a.core,c=b.evt.addEvent,d=b.evt.getEvent,e=b.str.trim,f=b.evt.reomveEvent,g=b.dom.sizzle,h=b.arr.foreach,i=b.evt.fireEvent,j=b.evt.stopEvent,k=a.E("weibo_list_con"),l=a.E("weibo_list"),m=a.E("fans_list_con"),n=location.search,o;(function(){var b=!1;o=function(b){function e(){document.getElementsByTagName("head")[0].appendChild(c)}var c=document.createElement("style");c.type="text/css";if(a.IE)c.styleSheet.cssText=b;else{var d=document.createDocumentFragment();d.appendChild(document.createTextNode(b));c.appendChild(d)}e()}})();var p=function(){var b=/colors=([A-Fa-f\d,]+)/.test(n)?RegExp.$1:"";if(b){b=b.split(",");var c="";b[0]&&(c+=".weiboShow .weiboShow_topborder, .weiboShow .weiboShow_title {background:#"+b[0]+";}\n");b[1]&&(c+=".weiboShow .weiboShow_wrap { background:#"+b[1]+" }\n");b[2]&&(c+=".weiboShow { color:#"+b[2]+";}\n .weiboShow .weiboShow_developerDetail_namedir {color:#"+b[2]+" }\n");b[3]&&(c+=".weiboShow a,\n .weiboShow .WB_linkA a,\n.weiboShow .WB_linkA, \n.weiboShow .WB_linkB a,\n.weiboShow .WB_linkB {color:#"+b[3]+" }");b[4]&&(c+=".weiboShow .weiboShow_mainFeed_list:hover, .weiboShow .weiboShow_mainFeed_list_focus{background:#"+b[4]+" ;}");o(c)}var d=/noborder=(\d+)/.test(n)?RegExp.$1:1;d==0&&(a.E("pl_weibo_show").className="WB_widgets weiboShow weiboShow_noborder");try{var e={};e.fansRow=/fansRow=(\d+)/.test(n)?RegExp.$1:2;e.isTitle=a.E("weibo_title")?1:0;e.isFans=m?1:0;e.isWeibo=a.E("weibo_con")?1:0;e.height=parseInt(a.E("pl_weibo_show").style.height,10);e.width=a.E("pl_weibo_show").offsetWidth}catch(f){}var h=e.height-30;e.isTitle==1&&(h-=30);a.E("weibo_head")&&(h-=86);if(!(h<0)){if(e.isFans){var i=g("li",m),j=0;if(i.length==0)j=m.offsetHeight;else{var p=m.getElementsByTagName("ul")[0],q=e.width,r=Math.floor((q-11)/66);r==0&&(r=1);var s="0 "+(q-16-r*66)/2+"px";try{p.style.padding=s}catch(f){var t=a.core.dom.cssText(p.style.cssText);t.push("padding",s);p.style.cssText=t.getCss()}var u=Math.ceil(i.length/r);e.fansRow=Math.min(e.fansRow,u,(h-30)/84>>0||1);j=e.fansRow*84;j>0&&(j-=12);j+=30;j>=h&&(j=h);m.style.height=parseInt(j-3)+"px"}h-=j}if(e.isWeibo){if(h<32){a.E("weibo_con").style.display="none";return}try{var v=null,w=function(){var b=l.offsetHeight;v&&clearInterval(v);if(b>0){var c;if(a.sizzle(".weiboShow_main_errorBox").length){c=(h-20>b?h-20:b)+"px";l.style.height=c}else c=(h-20>b?b:h-6)+"px";k.style.height=c}else v=setInterval(w,500)};w()}catch(f){}}}};return p});
STK.register("common.listener",function(a){var b={},c={};c.define=function(c,d){if(b[c]!=null)throw"common.listener.define: 频道已被占用";b[c]=d;var e={};e.register=function(d,e){if(b[c]==null)throw"common.listener.define: 频道未定义";a.listener.register(c,d,e)};e.fire=function(d,e){if(b[c]==null)throw"commonlistener.define: 频道未定义";a.listener.fire(c,d,e)};e.remove=function(b,d){a.listener.remove(c,b,d)};e.cache=function(b){return a.listener.cache(c,b)};return e};return c});
STK.register("common.channel.page",function(a){var b=["resize"];return a.common.listener.define("common.channel.page",b)});
STK.register("comp.widget.show.resize",function(a){return function(){var b={page:{width:document.body.clientWidth,height:document.body.clientHeight}};b=a.jsonToQuery(b.page);a.common.channel.page.fire("resize",b)}});
STK.register("common.xdomain",function(a){var b=window,c=document,d=0;return function(a,e){var f={};typeof e!="function"&&(e=function(){});var g=function(){var f="";if(b.postMessage){if(b.addEventListener)b.addEventListener("message",function(a){e.call(b,a.data)},!1);else if(b.attachEvent)b.attachEvent("onmessage",function(a){e.call(b,a.data)});else throw"[common.xDomain] addEventListener error";return function(b){a.postMessage(b,"*")}}setInterval(function(){if(b.name!==f){f=b.name;e.call(b,f)}},50);return function(b){a.name=+(new Date)+d++ +"^"+c.domain+"&"+escape(b)}};return g()}});
STK.register("comp.widget.show.xdomain",function(a){var b=0;return function(c){var d={setSize:a.common.xdomain(c)},e=function(){c=c||parent;var e={page:{width:document.body.clientWidth,height:document.body.clientHeight}};e=a.jsonToQuery(e.page);setInterval(function(){b<4&&d.setSize(e);b++},200)};d.resize=function(c){if(b<4)setTimeout(function(){d.resize(c)},200);else{var e=c||{page:{width:document.body.clientWidth,height:document.body.clientHeight}};e=a.jsonToQuery(e);d.setSize(e)}};var f=function(){};d.destroy=f;e();return d}});
STK.register("core.dom.isNode",function(a){return function(a){return a!=undefined&&Boolean(a.nodeName)&&Boolean(a.nodeType)}});
STK.register("core.arr.isArray",function(a){return function(a){return Object.prototype.toString.call(a)==="[object Array]"}});
STK.register("core.evt.custEvent",function(a){var b="__custEventKey__",c=1,d={},e=function(a,c){var e=typeof a=="number"?a:a[b];return e&&d[e]&&{obj:typeof c=="string"?d[e][c]:d[e],key:e}};return{define:function(a,e){if(a&&e){var f=typeof a=="number"?a:a[b]||(a[b]=c++),g=d[f]||(d[f]={});e=[].concat(e);for(var h=0;h<e.length;h++)g[e[h]]||(g[e[h]]=[]);return f}},undefine:function(a,c){if(a){var e=typeof a=="number"?a:a[b];if(e&&d[e])if(c){c=[].concat(c);for(var f=0;f<c.length;f++)c[f]in d[e]&&delete d[e][c[f]]}else delete d[e]}},add:function(a,b,c,d){if(a&&typeof b=="string"&&c){var f=e(a,b);if(!f||!f.obj)throw"custEvent ("+b+") is undefined !";f.obj.push({fn:c,data:d});return f.key}},once:function(a,b,c,d){if(a&&typeof b=="string"&&c){var f=e(a,b);if(!f||!f.obj)throw"custEvent ("+b+") is undefined !";f.obj.push({fn:c,data:d,once:!0});return f.key}},remove:function(b,c,d){if(b){var f=e(b,c),g,h;if(f&&(g=f.obj)){if(a.core.arr.isArray(g))if(d){var i=0;while(g[i]){if(g[i].fn===d)break;i++}g.splice(i,1)}else g.splice(0,g.length);else for(var i in g)g[i]=[];return f.key}}},fire:function(b,c,d){if(b&&typeof c=="string"){var f=e(b,c),g;if(f&&(g=f.obj)){a.core.arr.isArray(d)||(d=d!=undefined?[d]:[]);for(var h=g.length-1;h>-1&&g[h];h--){var i=g[h].fn,j=g[h].once;if(i&&i.apply)try{i.apply(b,[{type:c,data:g[h].data}].concat(d));j&&g.splice(h,1)}catch(k){a.log("[error][custEvent]"+k.message)}}return f.key}}},destroy:function(){d={};c=1}}});
STK.register("core.util.browser",function(a){var b=navigator.userAgent.toLowerCase(),c=window.external||"",d,e,f,g,h,i=function(a){var b=0;return parseFloat(a.replace(/\./g,function(){return b++==1?"":"."}))};try{/windows|win32/i.test(b)?h="windows":/macintosh/i.test(b)?h="macintosh":/rhino/i.test(b)&&(h="rhino");if((e=b.match(/applewebkit\/([^\s]*)/))&&e[1]){d="webkit";g=i(e[1])}else if((e=b.match(/presto\/([\d.]*)/))&&e[1]){d="presto";g=i(e[1])}else if(e=b.match(/msie\s([^;]*)/)){d="trident";g=1;(e=b.match(/trident\/([\d.]*)/))&&e[1]&&(g=i(e[1]))}else if(/gecko/.test(b)){d="gecko";g=1;(e=b.match(/rv:([\d.]*)/))&&e[1]&&(g=i(e[1]))}/world/.test(b)?f="world":/360se/.test(b)?f="360":/maxthon/.test(b)||typeof c.max_version=="number"?f="maxthon":/tencenttraveler\s([\d.]*)/.test(b)?f="tt":/se\s([\d.]*)/.test(b)&&(f="sogou")}catch(j){}var k={OS:h,CORE:d,Version:g,EXTRA:f?f:!1,IE:/msie/.test(b),OPERA:/opera/.test(b),MOZ:/gecko/.test(b)&&!/(compatible|webkit)/.test(b),IE5:/msie 5 /.test(b),IE55:/msie 5.5/.test(b),IE6:/msie 6/.test(b),IE7:/msie 7/.test(b),IE8:/msie 8/.test(b),IE9:/msie 9/.test(b),SAFARI:!/chrome\/([\d.]*)/.test(b)&&/\/([\d.]*) safari/.test(b),CHROME:/chrome\/([\d.]*)/.test(b),IPAD:/\(ipad/i.test(b),IPHONE:/\(iphone/i.test(b),ITOUCH:/\(itouch/i.test(b),MOBILE:/mobile/i.test(b)};return k});
STK.register("core.evt.getEvent",function(a){return function(){if(a.IE)return window.event;if(window.event)return window.event;var b=arguments.callee.caller,c,d=0;while(b!=null&&d<40){c=b.arguments[0];if(!(!c||c.constructor!=Event&&c.constructor!=MouseEvent&&c.constructor!=KeyboardEvent))return c;d++;b=b.caller}return c}});
STK.register("core.evt.fixEvent",function(a){return function(b){b=b||a.core.evt.getEvent();if(!b.target){b.target=b.srcElement;b.pageX=b.x;b.pageY=b.y}typeof b.layerX=="undefined"&&(b.layerX=b.offsetX);typeof b.layerY=="undefined"&&(b.layerY=b.offsetY);return b}});
STK.register("core.util.scrollPos",function(a){return function(a){a=a||document;var b=a.documentElement,c=a.body;return{top:Math.max(window.pageYOffset||0,b.scrollTop,c.scrollTop),left:Math.max(window.pageXOffset||0,b.scrollLeft,c.scrollLeft)}}});
STK.register("kit.util.drag",function(a){var b=function(a){a.cancelBubble=!0;return!1},c=function(b,c){b.clientX=c.clientX;b.clientY=c.clientY;b.pageX=c.clientX+a.core.util.scrollPos().left;b.pageY=c.clientY+a.core.util.scrollPos().top;b.offsetX=c.offsetX||c.layerX;b.offsetY=c.offsetY||c.layerY;b.target=c.target||c.srcElement;return b};return function(d,e){if(!a.core.dom.isNode(d))throw"core.util.drag need Element as first parameter";var f=a.core.obj.parseParam({actRect:[],actObj:{}},e),g={},h=a.core.evt.custEvent.define(f.actObj,"dragStart"),i=a.core.evt.custEvent.define(f.actObj,"dragEnd"),j=a.core.evt.custEvent.define(f.actObj,"draging"),k=function(d){var e=c({},d);document.body.onselectstart=function(){return!1};a.core.evt.addEvent(document,"mousemove",l);a.core.evt.addEvent(document,"mouseup",m);a.core.evt.addEvent(document,"click",b,!0);if(!a.IE){d.preventDefault();d.stopPropagation()}a.core.evt.custEvent.fire(h,"dragStart",e);return!1},l=function(b){var d=c({},b);b.cancelBubble=!0;a.core.evt.custEvent.fire(h,"draging",d)},m=function(d){var e=c({},d);document.body.onselectstart=function(){return!0};a.core.evt.removeEvent(document,"mousemove",l);a.core.evt.removeEvent(document,"mouseup",m);a.core.evt.removeEvent(document,"click",b,!0);a.core.evt.custEvent.fire(h,"dragEnd",e)};a.core.evt.addEvent(d,"mousedown",k);g.destroy=function(){a.core.evt.removeEvent(d,"mousedown",k);f=null};g.getActObj=function(){return f.actObj};return g}});
STK.register("common.widget.dragScroll",function(a){var b={},c=a.core.evt.addEvent,d=a.core.evt.custEvent;return function(e){var f,g,h,i,j,k,l,m,n,o,p=!1,q={contentOuter:null,contentInner:null,dragOuter:null,dragInner:null,dragInnerMinHeight:null};q=a.parseParam(q,e);var r=function(b){var b=b||window.event,c=b.target||b.srcElement;k=a.core.dom.position(h);var d=b.clientY-k.t,e;if(c!=i){e=parseInt(d*g.offsetHeight/h.offsetHeight,10);e>=Math.abs(f.offsetHeight-g.offsetHeight)&&(e=g.offsetHeight-f.offsetHeight);if(d<0)return;d+i.offsetHeight>h.offsetHeight&&(d=h.offsetHeight-i.offsetHeight);e>=Math.abs(f.offsetHeight-g.offsetHeight)&&(e=g.offsetHeight-f.offsetHeight);i.style.top=d+"px";g.style.marginTop=-1*e+"px"}},s=function(b){a.core.evt.stopEvent(b);var c=b.wheelDelta/120||b.detail/-3,d;if(!(Math.abs(c)>1)){if(c>0&&g.offsetTop>=0){d=0;return}if(c<0&&g.offsetTop<=f.offsetHeight-g.offsetHeight){d=0;return}d=c*40;c>0&&Math.abs(g.offsetTop)<d&&(d=c*Math.abs(g.offsetTop));c<0&&Math.abs(g.offsetTop-(f.offsetHeight-g.offsetHeight))<Math.abs(d)&&(d=c*Math.abs(g.offsetTop-(f.offsetHeight-g.offsetHeight)));t(d,c)}},t=function(a,b){var c,d;c=g.offsetTop+a;g.style.marginTop=c+"px";d=Math.round(c*h.offsetHeight/g.offsetHeight);i.style.top=-1*d+"px";g.offsetTop>=0?i.style.top="0px":g.offsetTop<=f.offsetHeight-g.offsetHeight&&(i.style.top=h.offsetHeight-i.offsetHeight+"px")},u={dragStart:function(a,b){m=b.offsetY},draging:function(b,c){var d,e,j,k=a.core.util.scrollPos();e=c.clientY-m-l.t+k.top;if(e<0)g.style.marginTop="0px";else{if(e+i.offsetHeight>h.offsetHeight){g.style.marginTop=f.offsetHeight-g.offsetHeight+"px";return}j=parseInt(e*g.offsetHeight/h.offsetHeight,10);if(j>=Math.abs(f.offsetHeight-g.offsetHeight))return;i.style.top=e+"px";g.style.marginTop=-1*j+"px"}},dragEnd:function(a,b){},dragMove:function(a){var b;b=g.offsetTop+a-j.t;g.style.marginTop=b+"px"}},v=function(a){document.attachEvent&&f.attachEvent("onmousewheel",s);if(document.addEventListener){f.addEventListener("mousewheel",s,!1);f.addEventListener("DOMMouseScroll",s,!1)}},w=function(a){document.attachEvent&&f.detachEvent("onmousewheel",s);if(document.addEventListener){f.removeEventListener("mousewheel",s,!1);f.removeEventListener("DOMMouseScroll",s,!1)}},x=function(){w();d.remove(drag.getActObj(),"dragStart",u.dragStart);d.remove(drag.getActObj(),"draging",u.draging)},y=function(){if(p){g.style.height=f.offsetHeight+"px";g.style.minHeight="";g.style.overflowY="scroll";h.style.display="none";i.style.display="none";x()}else{if(g.offsetHeight<=f.offsetHeight){g.style.marginTop="0px";i.style.height="0px";h.style.display="none";x();return}var b;h.style.display="block";j=a.core.dom.position(f);n=parseInt(f.offsetHeight*h.offsetHeight/g.offsetHeight,10);i.style.height=n+"px";b=-1*q.contentInner.offsetTop*q.dragOuter.offsetHeight/q.contentInner.offsetHeight;q.dragInner.style.top=b+"px";k=a.core.dom.position(h);if(g.offsetTop<=f.offsetHeight-g.offsetHeight){g.style.marginTop=f.offsetHeight-g.offsetHeight+"px";i.style.top=h.offsetHeight-i.offsetHeight+"px"}w();v()}},z=function(){if(q.contentOuter==null||q.contentInner==null||q.dragOuter==null||q.dragInner==null)throw"node is node defined"},A=function(){f=q.contentOuter;g=q.contentInner;h=q.dragOuter;i=q.dragInner},B=function(){drag=a.kit.util.drag(i);v();c(h,"click",r);d.add(drag.getActObj(),"dragStart",u.dragStart);d.add(drag.getActObj(),"draging",u.draging)},C=function(){var b=a.core.util.browser;p=b.MOBILE;if(p){g.style.height=f.offsetHeight+"px";g.style.minHeight="";g.style.overflowY="scroll";h.style.display="none";i.style.display="none";x()}else{if(g.offsetHeight<=f.offsetHeight){i.style.height="0px";h.style.display="none";x();return}h.style.display="block";g.style.marginTop="0px";i.style.top="0px";j=a.core.dom.position(f);k=a.core.dom.position(h);l=a.core.dom.position(i);n=Math.round(f.offsetHeight*h.offsetHeight/g.offsetHeight);q.dragInnerMinHeight&&(n=n>q.dragInnerMinHeight?n:q.dragInnerMinHeight);i.style.height=n+"px";o=i.offsetTop}},D=function(){z();A();B();C()};D();b.elmMove=t;b.init=C;b.destroy=x;b.reset=y;return b}});
typeof App=="undefined"&&(App={});typeof scope=="undefined"&&(scope=$CONFIG);STK.register("comp.widget.show.init",function(a){var b=a.core,c=b.evt.addEvent,d=b.evt.getEvent,e=b.str.trim,f=b.evt.reomveEvent,g=b.dom.sizzle,h=b.io.ajax,i=b.arr.foreach,j=b.evt.fireEvent,k=b.evt.stopEvent,l=a.kit.extra.language,m=a.comp.widget.show.scroll(),n=m.init_scroll,o=m.autoScroll,p=location.search,q=a.E("weibo_list_con"),r=a.E("weibo_list"),s=a.E("fans_list_con"),t='<cite class="WB_follow_status"><cite class="WB_follow_status_inner"><cite class="WB_follow_box"><u class="WB_icon_followed"></u>#L{已关注} </cite></cite></cite>',u=a.core.util.URL(document.location.href),v;return function(b,c){var d={},e,f=function(){var a=new Image,b="http://rs.sinajs.cn/tmp.gif?";b+="id=show&action=pv";b+="&uid="+($CONFIG.$uid||0);b+="&url="+encodeURIComponent(document.referrer);b+="&r="+(new Date).valueOf();a.src=b},g=function(){var c=a.pageSize();c.page.height=a.core.dom.getSize(b).height;var d=c.page;v.resize(d)},h=function(){a.comp.widget.show.style();j();f();a.E("scrollCon")?e=a.common.widget.dragScroll({contentOuter:a.E("weibo_list_con"),contentInner:a.E("weibo_list"),dragOuter:a.E("scrollCon"),dragInner:a.E("scrollBar"),dragInnerMinHeight:20}):n();if(scope.$isBD){v=a.comp.widget.show.xdomain(window.parent||window.self);k();g()}},j=function(){var b=a.E("followBtn"),c={uid:scope.$uid};u.getParam("followbtn")==1&&(c.btnTemp=t);b&&a.common.widget.addFollow(b,c);a.comp.widget.show.error()},k=function(){a.common.channel.page.register("resize",v.setSize)},l=function(){i(["up","down"],function(b,c){removeEvent(a.E("weibo_"+b+"btn"),"mouseover",function(){o.start(b)});removeEvent(a.E("weibo_"+b+"btn"),"mouseout",function(){o.stop()})})};h();d.destroy=l;return d}});
STK.pageletM.register("pl.widget.show",function(a){try{var b={},c=a.E("pl_weibo_show"),d=a.comp.widget.show.init(c,b);return d}catch(e){}});
STK.pageletM.start();
